<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Mini Miner ‚Äì styl Diamonds Explorer</title>
  <style>
    :root{ --cell:64px; --btn:48px; --mine:76px; }
    @media (max-height:700px),(max-width:420px){ :root{ --cell:56px; --btn:42px; --mine:64px; } }
    html,body{ margin:0; padding:0; height:100%; background:#0b0f16; color:#e8e8e8; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Helvetica Neue',Arial,'Noto Sans',sans-serif; touch-action:none; user-select:none; overscroll-behavior:none; }
    canvas{ display:block; width:100vw; height:100vh; }
    #ui{ position:fixed; inset:0; pointer-events:none; }
    #hud{ position:absolute; left:8px; right:8px; top:8px; display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:space-between; }
    #hud .panel{ pointer-events:auto; background:rgba(0,0,0,.45); backdrop-filter:blur(6px); border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:6px 10px; display:inline-flex; align-items:center; gap:10px; font-size:12px; }
    #inv{ gap:14px; }
    #inv .item{ display:inline-flex; align-items:center; gap:6px; }
    #inv .dot{ width:12px; height:12px; border-radius:3px; border:1px solid rgba(255,255,255,.35); display:inline-block; }
    #fps{ min-width:56px; text-align:right; opacity:.85; }
    #seedPanel input{ pointer-events:auto; background:rgba(20,20,25,.7); color:#e8e8e8; border:1px solid rgba(255,255,255,.18); border-radius:8px; padding:4px 8px; font-size:12px; width:130px; }
    #seedPanel button, .topbtn, .craftBtn{ pointer-events:auto; background:#2c7ef8; color:#fff; border:none; border-radius:10px; padding:6px 10px; font-weight:600; font-size:12px; box-shadow:0 2px 6px rgba(44,126,248,.35); cursor:pointer; }
    .topbtn.toggled{ background:#21a366; box-shadow:0 2px 10px rgba(33,163,102,.45); }
  #menuWrap{ position:relative; pointer-events:auto; }
  #menuBtn{ pointer-events:auto; background:#2c7ef8; color:#fff; border:none; border-radius:10px; padding:6px 12px; font-weight:600; font-size:14px; box-shadow:0 2px 6px rgba(44,126,248,.35); cursor:pointer; }
  #menuPanel{ position:absolute; right:0; top:110%; min-width:230px; background:rgba(15,18,26,.92); border:1px solid rgba(255,255,255,.15); border-radius:14px; padding:10px 10px 12px; display:flex; flex-direction:column; gap:10px; box-shadow:0 8px 28px -6px rgba(0,0,0,.6); backdrop-filter:blur(8px); }
  #menuPanel .group{ display:flex; flex-wrap:wrap; gap:6px; }
  #menuPanel .seedRow{ align-items:center; gap:6px; font-size:12px; }
  #menuPanel input{ background:rgba(20,20,25,.7); color:#e8e8e8; border:1px solid rgba(255,255,255,.18); border-radius:8px; padding:4px 6px; font-size:12px; width:110px; }
  #menuPanel .hint{ font-size:11px; opacity:.75; }
    #craft{ position:absolute; left:8px; top:54px; pointer-events:auto; display:flex; flex-direction:column; gap:6px; background:rgba(0,0,0,.45); border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:8px; max-width:min(55vw,340px); font-size:12px; }
    #craft .req{ font-size:11px; opacity:.9; }
    #help{ position:absolute; left:8px; right:8px; top:140px; background:rgba(0,0,0,.65); border:1px solid rgba(255,255,255,.18); border-radius:12px; padding:10px 12px; font-size:12px; line-height:1.4; display:none; pointer-events:auto; }
    #controls{ position:absolute; left:0; right:0; bottom:0; padding:12px; display:flex; justify-content:space-between; gap:12px; pointer-events:none; }
    .pad{ pointer-events:auto; display:grid; gap:8px; grid-template-columns:var(--cell) var(--cell) var(--cell); grid-template-rows:var(--cell) var(--cell) var(--cell); }
    .btn{ width:var(--btn); height:var(--btn); border-radius:16px; background:rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.25); box-shadow:inset 0 1px 4px rgba(0,0,0,.6), 0 4px 16px rgba(0,0,0,.35); display:flex; align-items:center; justify-content:center; font-size:18px; color:#fff; }
    .btn.on, .btn:active{ background:rgba(255,255,255,.25); }
    #dirRing{ position:absolute; right:8px; bottom:8px; pointer-events:auto; display:grid; grid-template-columns:repeat(3,var(--cell)); grid-template-rows:repeat(3,var(--cell)); }
    .dircell{ display:flex; align-items:center; justify-content:center; }
    .dirbtn{ width:var(--btn); height:var(--btn); border-radius:12px; border:1px solid rgba(255,255,255,.25); background:rgba(255,255,255,.10); color:#fff; font-size:16px; box-shadow:inset 0 1px 4px rgba(0,0,0,.6),0 2px 12px rgba(0,0,0,.25); }
    .dirbtn.sel{ outline:2px solid #2c7ef8; }
    #mineBtn{ width:var(--mine); height:var(--mine); border-radius:18px; font-size:24px; border:1px solid rgba(255,255,255,.3); background:linear-gradient(180deg,rgba(44,126,248,.95),rgba(29,92,204,.95)); box-shadow:0 8px 24px rgba(44,126,248,.35), inset 0 1px 3px rgba(255,255,255,.3); pointer-events:auto; }
    #mineBtn.on, #mineBtn:active{ filter:brightness(1.1); }
    #radarBtn{ position:absolute; right:8px; bottom:calc(8px + 3*var(--cell) + 10px); width:52px; height:52px; border-radius:14px; border:1px solid rgba(255,255,255,.3); background:rgba(255,255,255,.10); color:#fff; font-weight:700; box-shadow:inset 0 1px 4px rgba(0,0,0,.6),0 2px 12px rgba(0,0,0,.25); pointer-events:auto; }
    #radarBtn.pulse{ animation:radarPulse .9s infinite alternate; border-color:#4dd0ff; }
    @keyframes radarPulse{0%{ background:rgba(77,208,255,.15); box-shadow:0 0 0 rgba(77,208,255,0),0 0 16px rgba(77,208,255,.25);}100%{ background:rgba(77,208,255,.35); box-shadow:0 0 18px rgba(77,208,255,.45),0 0 28px rgba(77,208,255,.35);} }
    .pill{ background:rgba(0,0,0,.45); border:1px solid rgba(255,255,255,.12); border-radius:999px; padding:6px 10px; font-size:12px; }
    #errorBox{ position:absolute; left:8px; right:8px; top:50%; transform:translateY(-50%); background:#2b1e1e; color:#ffd7d7; border:1px solid #402b2b; border-radius:10px; padding:10px 12px; display:none; white-space:pre-wrap; font-family:ui-monospace,monospace; }
    #messages{ position:absolute; left:50%; top:8px; transform:translateX(-50%); font-size:12px; background:rgba(0,0,0,.5); padding:4px 10px; border-radius:999px; pointer-events:none; }
  </style>
</head>
<body>
  <canvas id="game" aria-label="Mini Miner"></canvas>
  <div id="ui">
    <div id="hud">
      <div id="inv" class="panel" aria-label="Ekwipunek" aria-live="polite">
        <span class="item"><span class="dot" style="background:#2e8b2e"></span> trawa: <b id="grass">0</b></span>
        <span class="item"><span class="dot" style="background:#c2b280"></span> piach: <b id="sand">0</b></span>
        <span class="item"><span class="dot" style="background:#777"></span> kamie≈Ñ: <b id="stone">0</b></span>
        <span class="item"><span class="dot" style="background:#3ef"></span> diamenty: <b id="diamond">0</b></span>
        <span class="item"><span class="dot" style="background:#8b5a2b"></span> drewno: <b id="wood">0</b></span>
  <span class="item"><span class="dot" style="background:#eee"></span> ≈õnieg: <b id="snow">0</b></span>
        <span class="item pill">kilof: <b id="pick">podstawowy</b></span>
      </div>
      <div class="panel"><span id="fps">‚Äî FPS</span></div>
      <div id="menuWrap">
  <button id="menuBtn" class="topbtn" aria-haspopup="true" aria-expanded="false" title="Menu" aria-label="Menu g≈Ç√≥wne">‚â°</button>
        <div id="menuPanel" role="menu" aria-label="Menu" hidden>
          <div class="group">
            <button id="mapBtn" class="topbtn" role="menuitem" title="Poka≈º ca≈ÇƒÖ mapƒô">Mapa: OFF</button>
            <button id="godBtn" class="topbtn" role="menuitem" title="Tryb boga (G)">B√≥g: OFF</button>
            <button id="centerBtn" class="topbtn" role="menuitem" title="Wy≈õrodkuj kamerƒô">Centruj</button>
            <button id="helpBtn" class="topbtn" role="menuitem" aria-controls="help" aria-expanded="false">Pomoc</button>
            <button id="radarMenuBtn" class="topbtn" role="menuitem" title="Radar diament√≥w">Radar üíé</button>
          </div>
          <div class="group seedRow"><label for="seedInput">Ziarno:</label><input id="seedInput" value="auto" /><button id="regenBtn">Nowy ≈õwiat</button></div>
          <div class="hint">Skr√≥ty: G=B√≥g, M=Mapa, C=Centrum, H=Pomoc</div>
          <div class="group" style="flex-direction:column; align-items:stretch; margin-top:4px;">
            <label style="font-size:12px; display:flex; justify-content:space-between; gap:8px; align-items:center;">Gƒôsto≈õƒá trawy <span id="grassDensityLabel">1.0</span></label>
            <input id="grassDensity" type="range" min="0" max="4" step="0.01" value="1" style="width:100%;" />
            <div class="hint">Reguluje liczbƒô ≈∫d≈∫be≈Ç / tile (skala logarytmiczna).</div>
          </div>
          <div class="group" style="flex-direction:column; align-items:stretch; margin-top:4px;">
            <label style="font-size:12px; display:flex; justify-content:space-between; gap:8px; align-items:center;">Wysoko≈õƒá trawy <span id="grassHeightLabel">1.0</span></label>
            <input id="grassHeight" type="range" min="0" max="2" step="0.01" value="1" style="width:100%;" />
            <div class="hint">Mno≈ºnik wysoko≈õci pojedynczych ≈∫d≈∫be≈Ç.</div>
          </div>
        </div>
      </div>
    </div>
  <!-- topButtons replaced by dropdown menu; old markup removed -->
    <div id="craft">
      <strong>Rzemios≈Ço</strong>
      <button class="craftBtn" id="craftStone">Kilof kamienny</button><div class="req">10 √ó kamie≈Ñ</div>
      <button class="craftBtn" id="craftDiamond">Kilof diamentowy</button><div class="req">5 √ó diament</div>
    </div>
  <div id="help">Sterowanie: A/D lub ‚Üê/‚Üí ruch, W / ‚Üë / Spacja skok, ‚õèÔ∏è lub klik kopanie. 1/2/3 wyb√≥r kilofa po craftingu. M (Mapa) ods≈Çania mg≈Çƒô. G (B√≥g) natychmiastowe kopanie. C centruje kamerƒô. H pomoc. Kierunek kopania wybierz przyciskami wok√≥≈Ç ‚õèÔ∏è.</div>
    <div id="controls">
      <div class="pad" id="pad">
        <div></div><div data-key="ArrowUp" class="btn">‚Üë</div><div></div>
        <div data-key="ArrowLeft" class="btn">‚Üê</div><div class="btn" style="opacity:.25"></div><div data-key="ArrowRight" class="btn">‚Üí</div>
        <div></div><div data-key="ArrowDown" class="btn">‚Üì</div><div></div>
      </div>
    </div>
    <div id="dirRing">
      <div class="dircell"><button class="dirbtn" data-dx="-1" data-dy="-1">‚Üñ</button></div>
      <div class="dircell"><button class="dirbtn" data-dx="0" data-dy="-1">‚Üë</button></div>
      <div class="dircell"><button class="dirbtn" data-dx="1" data-dy="-1">‚Üó</button></div>
      <div class="dircell"><button class="dirbtn" data-dx="-1" data-dy="0">‚Üê</button></div>
      <div class="dircell"><button id="mineBtn">‚õèÔ∏è</button></div>
      <div class="dircell"><button class="dirbtn" data-dx="1" data-dy="0">‚Üí</button></div>
      <div class="dircell"><button class="dirbtn" data-dx="-1" data-dy="1">‚Üô</button></div>
      <div class="dircell"><button class="dirbtn" data-dx="0" data-dy="1">‚Üì</button></div>
      <div class="dircell"><button class="dirbtn" data-dx="1" data-dy="1">‚Üò</button></div>
    </div>
    <button id="radarBtn" title="Radar diament√≥w (10√ó10)">üíé</button>
    <div id="messages"></div>
    <div id="errorBox" role="alert"></div>
  </div>
  <script src="src/engine/constants.js"></script>
  <script src="src/engine/worldgen.js"></script>
  <script src="src/engine/world.js"></script>
  <script src="src/engine/trees.js"></script>
  <script src="src/engine/cape.js"></script>
  <script src="src/main.js"></script>
</body>
</html>
